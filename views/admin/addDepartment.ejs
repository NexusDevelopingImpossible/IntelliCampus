<link rel="stylesheet" href="<%= assetPath('css/admin-addProgram.css') %>">

<div class="main-page">
  <div class="blur">
    <div class="page-heading">
      <a href="/admin/dashboard"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
          <path
            d="M381-100 44-436q-9-9-13.5-20.5T26-480q0-12 4.5-23.5T44-524l337-337q21-21 51-21.5t52 21.5q21 21 21 51.5T484-758L206-480l278 278q21 21 21.5 50.5T484-100q-21 21-51.5 21T381-100Z" />
        </svg></a>
      <h1 class="heading">Add Department</h1>
    </div>
    <div class="add-dept">
      <form action="/admin/adddepartment" method="post" id="adddept">
        <input class="prog-inp" id="prog-inp" type="text" placeholder="Enter Department" name="department" />
        <button type="submit" class="add-btn btn btn-full">Add</button>
      </form>
      <a href="/admin/program"><div class="add-pro-btn btn btn-full btn-large">Add Program</div></a>
    </div>
    <div class="prog-grid" id="dept-list">
      <%for(let i=0; i<dept.length; i++){%>
        <div class="prog-div">
          <p>
            <%=dept[i].department%>
          </p>
          <a class="trash" href="/admin/deletedepartment/<%=dept[i]._id%>"><svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" ><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"/></svg></a>
        </div>
        <%}%>
    </div>
  </div>
</div>
<script>
  const adddeptform = $('#adddept');
  $(document).on('submit', '#adddept', function (e) {
    e.preventDefault();
    $.ajax({
      type: 'post',
      url: '/admin/adddepartment',
      data: adddeptform.serialize(),
      success: function (data) {
        const nAtt = newattDom(data.data);
        new Noty({
          theme: 'relax',
          text: 'Department added',
          type: 'success',
          layout: 'topRight',
          timeout: 1500,
        }).show();
      },
      error: function (error) {
        console.log(error.responseText);
      }
    });
  });
  function newattDom(data){
    console.log(data)
    let deptdom = `<div class="prog-div">
          <p>
            ${data.dept.department}
          </p>
          <a class="trash" href="/admin/deletedepartment/${data.dept._id}"><svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" ><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"/></svg></a>
        </div>`
        $('#dept-list').append(deptdom);
        document.getElementById('prog-inp').value = '';

  }
</script>